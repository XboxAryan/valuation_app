# ðŸ“Š Investment Banking Pitch Book Generator

## Overview

Your valuation platform will now generate **Goldman Sachs-grade PDF pitch books** for investor meetings - the same quality presentations that top-tier investment banks create for their clients.

---

## What You'll Be Able to Generate

### 1. **Stock Pitch Deck (15-20 slides)**
Professional investment pitch for a single company

**Cover Slide:**
- Company logo and ticker
- Sector classification
- **BUY / HOLD / SELL recommendation** (large, prominent)
- Target price with upside %
- Date and analyst name

**Slide 2: Investment Thesis**
- 3-5 compelling bullet points
- Why this is a strong investment NOW
- Example:
  - âœ… Market leader with 35% share in growing cloud infrastructure space
  - âœ… 25% revenue CAGR driven by enterprise digital transformation
  - âœ… Expanding margins (from 18% to 23% EBITDA margin by 2027)
  - âœ… Strong FCF generation ($2.5B annually) supports buybacks
  - âœ… 45% upside to fair value of $285/share

**Slide 3: Company Overview**
- Business model description
- Key products/services
- Market position and competitive advantages
- Geographic footprint

**Slide 4-5: Financial Highlights**
- Revenue trend chart (5-year historical + 3-year forecast)
- EBITDA and margin expansion chart
- EPS growth trajectory
- Key metrics table (revenue, EBITDA, margins, EPS, FCF)

**Slide 6: Valuation Summary**
- Three valuation methods comparison:
  - DCF equity value
  - EV/EBITDA comparable companies
  - P/E comparable companies
- Final blended valuation
- Current market cap vs fair value
- **Implied upside/downside %**

**Slide 7: Scenario Analysis**
- Waterfall chart showing:
  - Bear case valuation ($180/share)
  - Base case valuation ($285/share)  â† Your recommendation
  - Bull case valuation ($350/share)
- Probability weighting (e.g., 25% / 50% / 25%)
- Key assumption differences between scenarios

**Slide 8: Key Metrics Dashboard**
- Table with current vs peer average:
  - P/E ratio
  - EV/EBITDA
  - EV/Revenue
  - ROE (Return on Equity)
  - ROIC (Return on Invested Capital)
  - FCF Yield
  - Debt/Equity

**Slide 9: Peer Comparison**
- Table showing company vs 5-7 peers:
  - Company name, ticker, market cap
  - Revenue growth
  - EBITDA margin
  - P/E multiple
  - EV/EBITDA multiple
- Color coding (green = favorable, red = unfavorable)

**Slide 10: Historical Trading Multiples**
- Chart showing 3-year P/E ratio bands (min/avg/max)
- Chart showing 3-year EV/EBITDA bands
- Current multiple vs historical average
- "Trading at 15.2x P/E vs 3-year avg of 18.5x â†’ implies upside"

**Slide 11: Key Catalysts & Upside Drivers**
- Near-term catalysts (next 12 months):
  - Q2 2025 earnings (May 15) - expect guidance raise
  - New product launch (June 2025) - $500M revenue potential
  - Regulatory approval (Q3 2025) - expands TAM by 30%
- Medium-term drivers:
  - International expansion (Europe, Asia)
  - Margin expansion from operational leverage

**Slide 12: Key Risks & Mitigants**
- Risk matrix with severity rating:
  - **Competition Risk** (High) - New entrant with lower pricing
    - *Mitigation:* Brand loyalty, switching costs, innovation pipeline
  - **Regulatory Risk** (Medium) - Potential antitrust scrutiny
    - *Mitigation:* Diversified business, proactive compliance
  - **Macro Risk** (Medium) - Recession could slow IT spending
    - *Mitigation:* Sticky enterprise contracts, recurring revenue model

**Slide 13-14: DCF Model Details**
- Assumptions table:
  - Revenue growth (Y1-Y3: 25%, 20%, 15%)
  - Terminal growth (2.5%)
  - WACC (9.8%)
  - Tax rate (21%)
  - Beta, risk-free rate, market risk premium
- Sensitivity heatmap:
  - Rows: Terminal growth (1.5% to 3.5%)
  - Columns: WACC (7.8% to 11.8%)
  - Color-coded valuation ranges

**Slide 15: Financial Projections**
- Full 3-statement forecast table (3-5 years)
- Income statement highlights
- Free cash flow build

**Appendix (Slides 16-20):**
- Detailed financial model
- Management team bios (CEO, CFO, COO)
- Industry overview
- Technical analysis / chart patterns
- Disclaimer and disclosures

---

### 2. **Investment Committee Memo (5-7 pages)**
Written recommendation for internal investment decisions

**Structure:**

**Page 1: Executive Summary**
- Recommendation in bold: **BUY** with $285 target price
- Quick facts box (ticker, sector, market cap, current price, upside)
- 3-sentence investment summary
- Risk rating (Medium)

**Page 2-3: Investment Rationale**
- Why this investment makes sense
- Competitive positioning
- Growth drivers (quantified)
- Margin expansion opportunity
- Capital allocation strategy
- Management quality assessment

**Page 4-5: Valuation Analysis**
- DCF methodology walkthrough
- Comparable companies analysis
- Precedent transactions (if applicable)
- Sum-of-the-parts (if multi-business)
- Scenario analysis with probabilities
- Valuation sensitivity to key assumptions

**Page 6: Risk Assessment**
- Detailed risk discussion
- Probability and impact analysis
- Downside protection (what % downside in bear case?)
- Position sizing recommendation

**Page 7: Conclusion & Action Items**
- Restate recommendation
- Entry price target
- Stop loss / exit criteria
- Monitoring metrics (what to watch)

---

### 3. **Quarterly Portfolio Review (10-15 pages)**
Summary of entire portfolio performance and recommendations

**Structure:**

**Page 1: Executive Dashboard**
- Portfolio value and YTD return
- Performance vs S&P 500 and sector benchmarks
- Sector allocation pie chart
- Top 10 holdings table

**Page 2-3: Performance Attribution**
- What drove portfolio returns this quarter
- Winners and losers (contribution to return)
- Sector performance breakdown
- Style analysis (growth vs value, large vs small cap)

**Page 4-5: Top Stock Picks**
- 5-10 highest conviction ideas
- Each with: ticker, target price, upside %, recommendation, 2-sentence thesis

**Page 6-7: Sector Deep Dive**
- Sector-by-sector analysis
- Overweight/underweight recommendations
- Best ideas per sector

**Page 8-9: Valuation Changes**
- Companies with significant fair value changes this quarter
- What changed (earnings, multiples, sentiment)
- New buys and sells

**Page 10-11: Upcoming Catalysts Calendar**
- Table of key dates:
  - Earnings announcements
  - Product launches
  - Regulatory decisions
  - Management presentations

**Page 12-13: Risk Dashboard**
- Portfolio-level metrics:
  - Weighted avg P/E
  - Weighted avg ROE
  - Weighted avg debt/equity
  - Beta (portfolio risk)
  - Average Z-score (bankruptcy risk)

**Page 14-15: Appendix**
- Full portfolio holdings list
- Detailed valuation table
- Methodology notes

---

## What Data You'll Need to Provide

For high-quality pitch books, the platform will need additional data beyond just financial metrics. You'll fill this in through a **Pitch Book Builder UI**:

### Required Fields per Company:

1. **Investment Thesis** (3-5 bullet points)
   - Why is this a good investment?
   - What makes it compelling NOW?

2. **Business Description** (2-3 paragraphs)
   - What does the company do?
   - How do they make money?
   - What's their competitive advantage?

3. **Key Products/Services** (list)
   - Product A: Description, % of revenue
   - Product B: Description, % of revenue

4. **Management Team**
   - CEO: Name, title, 2-sentence bio
   - CFO: Name, title, 2-sentence bio
   - Key executives

5. **Key Catalysts** (upcoming events)
   - Date, event name, expected impact
   - Example: "Q2 2025 Earnings (May 15) - Expect guidance raise on cloud momentum"

6. **Key Risks**
   - Risk name, severity (Low/Medium/High), mitigation strategy
   - Example: "Competition Risk (High) - New entrant with lower pricing | Mitigation: Brand loyalty, 3-year contracts lock in customers"

7. **Company Logo**
   - URL to logo image (will fetch and embed)
   - Or upload directly

8. **Target Price**
   - Your price target (can differ from fair value if you adjust for timing)
   - Rationale (1-2 sentences)

9. **Peer Companies**
   - Select 5-7 comparable companies from your database
   - Used for peer comparison table

10. **Analyst Notes** (optional)
    - Any additional context for the pitch

---

## How It Works (User Workflow)

### Step 1: Add Pitch Data
1. Go to company page (e.g., Apple)
2. Click **"Build Pitch Book"** button
3. Fill in pitch data form:
   - Investment thesis editor (rich text)
   - Business description (WYSIWYG)
   - Add catalysts (calendar picker + impact)
   - Add risks (drag to reorder by importance)
   - Upload or link company logo
   - Select peer companies from dropdown

### Step 2: Preview Pitch
- Live preview shows each slide/page
- Navigate through slides
- Edit mode lets you tweak formatting

### Step 3: Generate PDF
1. Select report type:
   - â˜ Stock Pitch Deck (15-20 slides)
   - â˜ Investment Committee Memo (5-7 pages)
   - â˜ Quarterly Portfolio Review (10-15 pages)

2. Select scenarios to include:
   - â˜ Bear Case
   - â˜‘ Base Case (always included)
   - â˜ Bull Case

3. Select template style:
   - â˜ Goldman Sachs style (blue/grey, conservative)
   - â˜ JP Morgan style (black/gold, classic)
   - â˜ Morgan Stanley style (blue/white, modern)

4. Click **"Generate PDF"**
   - Processing takes 30-60 seconds
   - Charts generated via matplotlib
   - PDF rendered via WeasyPrint
   - Download automatically starts

### Step 4: Present to Investors
- Open PDF in presentation mode
- Professional, polished slides
- Ready for investor meetings, IC presentations, client calls

---

## Technical Implementation

### Database Tables (3 new)

**1. `company_pitch_data`**
```sql
- company_id (FK to companies)
- investment_thesis (TEXT - bullet points)
- business_description (TEXT - paragraphs)
- key_products (JSON - [{name, description, revenue_pct}])
- management_team (JSON - [{name, title, bio, photo_url}])
- key_catalysts (JSON - [{date, event, impact}])
- key_risks (JSON - [{risk, severity, mitigation}])
- company_logo_url (TEXT)
- target_price (REAL)
- target_price_rationale (TEXT)
- peer_company_ids (JSON - [1, 5, 8, 12, 15])
- analyst_notes (TEXT)
- last_updated_by, last_updated_at
```

**2. `historical_prices`**
```sql
- company_id (FK)
- date, price, volume
- pe_ratio, ev_ebitda_ratio
- INDEX on (company_id, date)
```
*Used for historical trading multiple charts*

**3. `pitch_book_history`**
```sql
- company_id (FK)
- generated_at, generated_by
- report_type (pitch_deck, ic_memo, portfolio_review)
- file_path (where PDF is stored)
- scenario_ids (JSON - which scenarios included)
- viewed_count, last_viewed_at
```
*Track all generated pitch books for download history*

### New Python Module: `pitch_book_generator.py`

```python
class PitchBookGenerator:
    def __init__(self, company_id, scenario_ids, template_style):
        self.company = load_company(company_id)
        self.pitch_data = load_pitch_data(company_id)
        self.scenarios = load_scenarios(scenario_ids)
        self.template_style = template_style

    def generate_stock_pitch_deck(self) -> str:
        """Generate 15-20 slide PDF pitch deck"""
        # Create slides using Jinja2 templates
        slides = []
        slides.append(self._render_cover_slide())
        slides.append(self._render_investment_thesis())
        slides.append(self._render_company_overview())
        slides.append(self._render_financial_highlights())
        slides.append(self._render_valuation_summary())
        slides.append(self._render_scenario_analysis())
        slides.append(self._render_key_metrics())
        slides.append(self._render_peer_comparison())
        slides.append(self._render_historical_multiples())
        slides.append(self._render_catalysts())
        slides.append(self._render_risks())
        slides.append(self._render_dcf_details())
        slides.append(self._render_projections())
        slides.extend(self._render_appendix())

        # Convert to PDF using WeasyPrint
        html = self._combine_slides(slides)
        pdf_path = self._render_to_pdf(html)

        # Save to pitch_book_history
        self._save_history(pdf_path, 'pitch_deck')

        return pdf_path

    def _render_scenario_analysis(self) -> str:
        """Create waterfall chart for bear/base/bull scenarios"""
        import matplotlib.pyplot as plt

        fig, ax = plt.subplots(figsize=(10, 6))

        scenarios = ['Bear', 'Base', 'Bull']
        values = [
            self.scenarios['bear'].equity_value,
            self.scenarios['base'].equity_value,
            self.scenarios['bull'].equity_value
        ]

        colors = ['#d32f2f', '#1976d2', '#388e3c']  # Red, Blue, Green
        ax.bar(scenarios, values, color=colors)

        # Add current price line
        ax.axhline(self.company.current_price,
                   color='black', linestyle='--',
                   label=f'Current Price: ${self.company.current_price}')

        plt.title('Valuation Scenario Analysis', fontsize=16, fontweight='bold')
        plt.ylabel('Equity Value per Share ($)')
        plt.legend()

        chart_path = f'/tmp/scenario_chart_{self.company.id}.png'
        plt.savefig(chart_path, dpi=300, bbox_inches='tight')
        plt.close()

        return self._render_template('scenario_slide.html', {
            'chart_path': chart_path,
            'bear_value': values[0],
            'base_value': values[1],
            'bull_value': values[2],
            'current_price': self.company.current_price
        })
```

### New API Endpoints

```python
@app.route('/api/pitch-data/<int:company_id>', methods=['GET', 'PUT'])
def manage_pitch_data(company_id):
    """Get or update pitch book data for a company"""
    if request.method == 'GET':
        return jsonify(get_pitch_data(company_id))
    else:
        update_pitch_data(company_id, request.json)
        return jsonify({'success': True})

@app.route('/api/reports/pitch-book/<int:company_id>', methods=['POST'])
def generate_pitch_book(company_id):
    """Generate stock pitch deck PDF"""
    scenario_ids = request.json.get('scenario_ids', [1, 2, 3])  # bear, base, bull
    template_style = request.json.get('template', 'goldman')

    generator = PitchBookGenerator(company_id, scenario_ids, template_style)
    pdf_path = generator.generate_stock_pitch_deck()

    return jsonify({
        'success': True,
        'pdf_url': f'/downloads/{pdf_path}',
        'file_size': get_file_size(pdf_path)
    })

@app.route('/api/reports/ic-memo/<int:company_id>', methods=['POST'])
def generate_ic_memo(company_id):
    """Generate Investment Committee memo PDF"""
    # Similar structure to pitch book generation
    ...

@app.route('/api/reports/portfolio-review', methods=['POST'])
def generate_portfolio_review():
    """Generate quarterly portfolio review PDF"""
    # Aggregate data across all companies
    ...
```

---

## Template Styles

### Goldman Sachs Style
- **Colors:** Navy blue (#003f7f) and grey (#6c757d)
- **Font:** Arial or Helvetica (clean, professional)
- **Layout:** Conservative, data-heavy tables
- **Charts:** Muted blue bars, minimal decoration
- **Footer:** Page numbers, confidentiality notice
- **Vibe:** Serious, institutional, trust-focused

### JP Morgan Style
- **Colors:** Black (#000000) and gold (#b8860b)
- **Font:** Times New Roman (classic serif)
- **Layout:** Traditional, formal
- **Charts:** Black/gold color scheme
- **Footer:** Page numbers, firm logo
- **Vibe:** Classic banking, established, authoritative

### Morgan Stanley Style
- **Colors:** Royal blue (#0033a0) and white
- **Font:** Calibri (modern sans-serif)
- **Layout:** Clean, spacious, modern
- **Charts:** Vibrant blue with gradients
- **Footer:** Minimalist
- **Vibe:** Modern, forward-thinking, tech-savvy

---

## Example Output Quality

Your generated pitch books will look like this:

**Page Quality:**
- Print-ready 8.5" x 11" or A4
- 300 DPI resolution
- Professional typography
- Crisp charts and tables
- Properly aligned elements

**Chart Quality:**
- Generated via matplotlib with custom styling
- High-resolution PNG embedded in PDF
- Color-coded (green = good, red = bad)
- Axis labels, titles, legends

**Data Formatting:**
- Currency: $1,234.5M (millions)
- Percentages: 45.3% (one decimal)
- Multiples: 18.5x (one decimal)
- Dates: May 15, 2025 (full format)

---

## Timeline

**Phase 3: Week 2-3** (after scenario management is built)
- Create database tables for pitch data
- Build `pitch_book_generator.py`
- Create HTML/CSS templates for each slide type
- Implement chart generation (matplotlib)

**Phase 3: Week 4**
- Build Pitch Book Builder UI
- Investment thesis editor
- Catalysts calendar
- Risk matrix
- Logo uploader

**Phase 3: Week 5**
- PDF generation and rendering
- Template styling (3 styles)
- Download functionality
- Testing with sample companies

**Total: 3-4 weeks** to have fully functional pitch book system

---

## Competitive Advantage

**What This Gives You:**

âœ… **Speed**: Generate professional pitch in 60 seconds (vs 4-8 hours manually)
âœ… **Consistency**: Every pitch follows IB standards
âœ… **Customization**: Bear/base/bull scenarios with your assumptions
âœ… **Professional Quality**: Indistinguishable from bulge bracket bank pitches
âœ… **Easy Updates**: Change assumptions, regenerate instantly
âœ… **Meeting-Ready**: No PowerPoint needed, just print PDF

**What Banks Charge for This:**
- Boutique investment banks: $5,000 - $15,000 per pitch book
- Bulge bracket banks: $25,000 - $50,000+ for detailed pitch materials
- **You:** $0 (automated)

**Use Cases:**
- Investor meetings (LP presentations)
- Client pitches (if you're raising capital)
- Internal investment committee decisions
- Board presentations
- Quarterly fund updates
- Marketing materials for your fund

---

## Next Steps

Once Phase 0 (foundation) is complete, we'll implement this in Phase 3. The pitch book generator will integrate seamlessly with:

1. **Scenario system** (Phase 1) - Pull bear/base/bull valuations
2. **Macro framework** (Phase 2) - Show GDP/inflation context
3. **Peer benchmarking** (Phase 2) - Auto-populate peer comparison
4. **Sensitivity analysis** (Phase 2) - Embed heatmaps in DCF details slide

Ready to build this when you give the go-ahead!
